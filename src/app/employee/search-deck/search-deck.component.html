<div class="bg-gradient-to-br from-blue-50 via-blue-100 to-indigo-50 min-h-screen font-sans text-gray-900">
    <div class="flex h-screen">

        <!-- SIDEBAR (fixed height) -->
        <aside class="w-64 bg-white border-r border-gray-200 flex flex-col shadow-xs">

            <!-- Logo -->
            <a routerLink="/dashboard" class="bg-black p-4 flex items-center justify-center border-b border-gray-200">
                <img src="https://admatazz.co.in/wp-content/uploads/2022/09/logo_f-ai-2-1.png" alt="Admatazz Logo"
                    class="w-36 h-auto object-contain" />
            </a>

            <!-- Navigation -->
            <nav class="flex-1 p-2 overflow-y-auto space-y-1">

                <!-- New Chat Button -->
                <button (click)="startNewChat()"
                    class="w-full flex items-center gap-3 px-3 py-2 hover:bg-blue-100 rounded-lg transition text-left text-sm font-medium">
                    <i class="fas fa-pen text-blue-500"></i>
                    <span>New Chat</span>
                </button>

                <!-- Chat History -->
                <div class="mt-6 mb-2 px-3 text-xs font-medium text-blue-700 uppercase tracking-wide">
                    Chat History
                </div>

                <div *ngFor="let chat of allChats">
                    <button (click)="selectChat(chat.id)"
                        class="w-full flex items-center gap-3 px-3 py-2 hover:bg-blue-100 rounded-lg transition text-left text-sm font-medium">
                        <i class="fas fa-comment text-blue-500 text-xs"></i>
                        <span>{{ chat.name }}</span>
                    </button>
                </div>
            </nav>

            <div class="mt-auto px-3 pb-3">
                <button (click)="logout()"
                    class="w-full text-left px-3 py-2 hover:bg-red-100 text-red-600 rounded-lg transition text-sm font-medium flex items-center gap-2">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
            </div>

            <!-- User Profile -->
            <div *ngIf="currentUser" class="p-3 border-t border-gray-200 flex items-center gap-3 mt-auto">
                <!-- Avatar -->
                <div
                    class="w-10 h-10 rounded-full overflow-hidden border-2 border-gray-300 flex items-center justify-center bg-gray-200">

                    <div
                        class="w-full h-full flex items-center justify-center text-white font-medium text-sm bg-gradient-to-br from-blue-400 to-indigo-500">
                        {{ currentUser.displayName.charAt(0) + (currentUser.displayName.split('
                        ').slice(-1)[0]?.charAt(0) || '') }}
                    </div>

                </div>

                <!-- User Info -->
                <div class="flex flex-col">
                    <span class="text-sm font-medium">{{ currentUser.displayName }}</span>
                    <span class="text-xs text-gray-500">{{ currentUser.email }}</span>
                </div>
            </div>


        </aside>

        <!-- MAIN CONTENT -->
        <div class="flex-1 flex flex-col h-full">

            <!-- HEADER (fixed) -->
            <header
                class="h-16 border-b border-gray-200 flex items-center justify-between px-6 bg-white sticky top-0 z-50 shadow-xs">
                <div class="flex items-center gap-2">
                    <span class="font-semibold text-gray-900 text-lg">Search Decks</span>
                    <button class="p-1 hover:bg-blue-100 rounded transition">
                        <i class="fas fa-chevron-down text-xs text-gray-600"></i>
                    </button>
                </div>
                <div class="flex items-center gap-3">
                    <button class="p-2 hover:bg-blue-100 rounded transition">
                        <i class="far fa-comment-dots text-blue-500"></i>
                    </button>
                </div>
            </header>

            <!-- CHAT AREA (scrollable only in message section) -->
            <main class="flex-1 flex flex-col overflow-hidden px-4 py-6">

                <h1 class="text-4xl font-bold text-gray-900 mb-4 text-center animate-float">
                    {{ timeEmoji }} Hey {{ (currentUser?.displayName || '').split(' ')[0] }} ‚òï, what's on the agenda
                    today? üìù
                </h1>

                <!-- SCROLLABLE MESSAGE CONTAINER -->
                <div #chatContainer class="w-full flex-1 overflow-y-auto space-y-4 mb-4">

                    <div *ngFor="let msg of chatHistory" class="transition-all duration-300 ease-in-out">

                        <!-- User message -->
                        <div *ngIf="msg.role === 'user'" class="flex justify-end">
                            <div
                                class="bg-blue-500 text-white px-4 py-2 rounded-lg max-w-xs break-words animate-fade-in">
                                {{ msg.content }}
                            </div>
                        </div>

                        <!-- Assistant message -->
                        <div *ngIf="msg.role === 'assistant'" class="flex justify-start">
                            <div
                                class="bg-gray-200 text-gray-900 px-4 py-2 rounded-lg max-w-xs break-words animate-fade-in">
                                {{ msg.content }}
                            </div>
                        </div>

                        <!-- System message -->
                        <div *ngIf="msg.role === 'system'" class="text-center text-xs text-gray-500 italic">
                            {{ msg.content }}
                        </div>
                    </div>

                    <!-- Typing indicator -->
                    <div *ngIf="loading" class="flex justify-start">
                        <div class="bg-gray-200 text-gray-900 px-4 py-2 rounded-lg max-w-xs animate-pulse">
                            GPT is typing...
                        </div>
                    </div>

                </div>

                <!-- INPUT BOX (stays at bottom) -->
                <div class="w-full relative mt-auto">
                    <div
                        class="flex items-center gap-3 px-4 py-3 border border-blue-300 rounded-full hover:border-blue-400 transition bg-white shadow-md focus-within:ring-2 focus-within:ring-blue-300">

                        <!-- Add Button -->
                        <button class="text-blue-400 hover:text-blue-600 transition">
                            <i class="fas fa-plus"></i>
                        </button>

                        <!-- Input Field -->
                        <input type="text" placeholder="Ask anything" [(ngModel)]="userMessage"
                            (keyup.enter)="sendMessage()"
                            class="flex-1 outline-none text-gray-700 placeholder-blue-300 bg-transparent" />

                        <!-- Microphone -->
                        <button class="text-blue-400 hover:text-blue-600 transition">
                            <i class="fas fa-microphone"></i>
                        </button>

                        <!-- Settings -->
                        <button class="text-blue-400 hover:text-blue-600 transition">
                            <i class="fas fa-sliders"></i>
                        </button>

                        <!-- Send Button -->
                        <button (click)="sendMessage()"
                            class="bg-blue-500 text-white px-4 py-2 rounded-full hover:bg-blue-600 transition">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" class="size-5">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
                            </svg>
                        </button>
                    </div>
                </div>

            </main>
        </div>
    </div>
</div>